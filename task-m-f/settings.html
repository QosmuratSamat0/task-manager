<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TaskManager Â· Settings</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="assets/style.css">
</head>
<body>
  <header id="app-header"></header>
  <main class="container py-5" style="max-width: 720px;">
    <h1 class="h4 mb-4">Settings</h1>
    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <h6 class="fw-semibold">Theme</h6>
        <p class="text-muted small mb-2">Toggle dark/light. Preference saved in local storage.</p>
        <button class="btn btn-outline-primary" onclick="tmToggleTheme()">Toggle Theme</button>
      </div>
    </div>

    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <h6 class="fw-semibold">API Base URL</h6>
        <p class="text-muted small mb-2">Default is <code>http://localhost:3000</code>. Update if your backend runs elsewhere.</p>
        <div class="input-group">
          <span class="input-group-text">Base</span>
          <input id="apiBase" type="text" class="form-control" placeholder="http://localhost:3000">
          <button id="saveApiBase" class="btn btn-primary">Save</button>
          <button id="resetApiBase" class="btn btn-outline-secondary">Reset</button>
        </div>
        <div class="small text-muted mt-2">Current: <code id="apiBaseCur"></code></div>
      </div>
    </div>

    <div class="card shadow-sm">
      <div class="card-body">
        <h6 class="fw-semibold">Account</h6>
        <p class="text-muted small mb-2">Clear your saved session.</p>
        <button id="clearSession" class="btn btn-outline-danger">Clear Local Data</button>
      </div>
    </div>
  </main>
  <div id="app-footer"></div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="assets/app.js"></script>
  <script src="assets/components.js"></script>
  <script src="assets/api.js"></script>
  <script>
    const baseInput = document.getElementById('apiBase');
    const current = document.getElementById('apiBaseCur');
    const refreshCur = () => current.textContent = TM_API.baseURL();
    refreshCur();
    document.getElementById('saveApiBase').addEventListener('click', () => {
      const v = baseInput.value.trim();
      if (!v) return;
      localStorage.setItem('tm_api_base', v);
      refreshCur();
      alert('Saved');
    });
    document.getElementById('resetApiBase').addEventListener('click', () => {
      localStorage.removeItem('tm_api_base');
      baseInput.value = '';
      refreshCur();
    });
    document.getElementById('clearSession').addEventListener('click', () => {
      if (!confirm('Clear local app data?')) return;
      localStorage.removeItem('tm_user');
      window.name = '';
      alert('Local session cleared');
    });
  </script>
</body>
</html>
